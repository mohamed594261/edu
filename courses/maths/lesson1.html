<!doctype html>
<html lang="ar" dir="rtl" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø¯Ø±Ø³ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap');
        
        * {
            font-family: 'Tajawal', sans-serif;
        }
        
        .number-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .number-card:hover {
            transform: translateY(-8px) scale(1.05);
        }
        
        .number-card.selected {
            transform: scale(1.1);
            box-shadow: 0 0 0 4px #fbbf24;
        }
        
        .fruit-emoji {
            font-size: 2rem;
            display: inline-block;
            animation: pop 0.3s ease;
        }
        
        @keyframes pop {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .bounce {
            animation: bounce 0.5s ease;
        }
        
        @keyframes celebration {
            0% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.2) rotate(10deg); }
            75% { transform: scale(1.2) rotate(-10deg); }
            100% { transform: scale(1) rotate(0deg); }
        }
        
        .celebrate {
            animation: celebration 0.6s ease;
        }
        
        .star {
            position: absolute;
            font-size: 1.5rem;
            animation: float 2s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full">
  <div class="w-full h-full overflow-auto" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
   <div class="w-full min-h-full p-6"><!-- Header -->
    <div class="text-center mb-8 relative">
     <div class="star" style="right: 10%; top: 0;">
      â­
     </div>
     <div class="star" style="left: 10%; top: 20px; animation-delay: 0.5s;">
      âœ¨
     </div>
     <h1 id="lesson-title" class="text-white mb-2" style="font-weight: 900;">ğŸ“ Ø¯Ø±Ø³ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ù…Ù† Ù¡ Ø¥Ù„Ù‰ Ù¥</h1>
     <p id="lesson-subtitle" class="text-white text-opacity-90">ØªØ¹Ù„Ù… Ø§Ù„Ø¹Ø¯ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù…Ù…ØªØ¹Ø©!</p>
    </div><!-- Instructions -->
    <div class="bg-white bg-opacity-95 rounded-3xl p-6 mb-6 shadow-2xl max-w-4xl mx-auto">
     <div class="flex items-center gap-3 mb-4"><span class="text-4xl">ğŸ“š</span>
      <h2 class="text-purple-700" style="font-weight: 700;">ÙƒÙŠÙ Ù†Ù„Ø¹Ø¨ØŸ</h2>
     </div>
     <p id="instructions-text" class="text-purple-900 leading-relaxed">Ø§Ø®ØªØ± Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ØµØ­ÙŠØ­ Ø§Ù„Ø°ÙŠ ÙŠÙ…Ø«Ù„ Ø¹Ø¯Ø¯ Ø§Ù„ÙÙˆØ§ÙƒÙ‡ Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©!</p>
    </div><!-- Game Area -->
    <div class="bg-white bg-opacity-95 rounded-3xl p-8 mb-6 shadow-2xl max-w-4xl mx-auto"><!-- Fruits Display -->
     <div class="text-center mb-8">
      <div id="fruits-container" class="flex justify-center items-center gap-3 flex-wrap min-h-32"></div>
     </div><!-- Numbers Selection -->
     <div class="mb-6">
      <h3 class="text-center mb-4 text-purple-700" style="font-weight: 700;">Ø§Ø®ØªØ± Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ØµØ­ÙŠØ­:</h3>
      <div id="numbers-container" class="grid grid-cols-5 gap-4 max-w-2xl mx-auto"></div>
     </div><!-- Feedback Area -->
     <div id="feedback" class="text-center min-h-16 flex items-center justify-center"></div>
    </div><!-- Score Display -->
    <div class="bg-white bg-opacity-95 rounded-3xl p-6 shadow-2xl max-w-4xl mx-auto">
     <div class="flex justify-between items-center">
      <div class="text-center flex-1">
       <div class="text-4xl mb-2">
        ğŸ†
       </div>
       <div class="text-purple-700" style="font-weight: 700;">
        Ø§Ù„Ù†Ù‚Ø§Ø·
       </div>
       <div id="score" class="text-purple-900" style="font-weight: 900;">
        0
       </div>
      </div>
      <div class="text-center flex-1">
       <div class="text-4xl mb-2">
        ğŸ¯
       </div>
       <div class="text-purple-700" style="font-weight: 700;">
        Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª
       </div>
       <div id="attempts" class="text-purple-900" style="font-weight: 900;">
        0
       </div>
      </div>
      <div class="text-center flex-1"><button id="next-btn" class="bg-gradient-to-r from-green-400 to-green-600 text-white px-6 py-3 rounded-2xl shadow-lg hover:from-green-500 hover:to-green-700 transition-all" style="font-weight: 700;"> Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯ ğŸ”„ </button>
      </div>
     </div>
    </div>
   </div>
  </div>
  <script>
        const defaultConfig = {
            background_color: '#667eea',
            card_background: '#ffffff',
            primary_color: '#7c3aed',
            button_color: '#10b981',
            accent_color: '#fbbf24',
            font_family: 'Tajawal',
            font_size: 18,
            lesson_title: 'ğŸ“ Ø¯Ø±Ø³ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ù…Ù† Ù¡ Ø¥Ù„Ù‰ Ù¥',
            lesson_subtitle: 'ØªØ¹Ù„Ù… Ø§Ù„Ø¹Ø¯ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù…Ù…ØªØ¹Ø©!',
            instructions_text: 'Ø§Ø®ØªØ± Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ØµØ­ÙŠØ­ Ø§Ù„Ø°ÙŠ ÙŠÙ…Ø«Ù„ Ø¹Ø¯Ø¯ Ø§Ù„ÙÙˆØ§ÙƒÙ‡ Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©!',
            success_message: 'Ø£Ø­Ø³Ù†Øª! Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! ğŸ‰'
        };

        const fruits = ['ğŸ', 'ğŸŠ', 'ğŸŒ', 'ğŸ‡', 'ğŸ“', 'ğŸ‰', 'ğŸ‘', 'ğŸ¥'];
        let currentAnswer = 0;
        let score = 0;
        let attempts = 0;

        function generateQuestion() {
            currentAnswer = Math.floor(Math.random() * 5) + 1;
            const fruitsContainer = document.getElementById('fruits-container');
            fruitsContainer.innerHTML = '';
            
            const randomFruit = fruits[Math.floor(Math.random() * fruits.length)];
            
            for (let i = 0; i < currentAnswer; i++) {
                setTimeout(() => {
                    const fruitSpan = document.createElement('span');
                    fruitSpan.className = 'fruit-emoji';
                    fruitSpan.textContent = randomFruit;
                    fruitsContainer.appendChild(fruitSpan);
                }, i * 100);
            }
            
            const numbersContainer = document.getElementById('numbers-container');
            numbersContainer.innerHTML = '';
            
            for (let i = 1; i <= 5; i++) {
                const numberCard = document.createElement('div');
                numberCard.className = 'number-card bg-gradient-to-br from-purple-400 to-pink-400 text-white rounded-2xl p-6 text-center shadow-lg';
                numberCard.innerHTML = `<div style="font-weight: 900; font-size: ${defaultConfig.font_size * 2}px;">${i}</div>`;
                numberCard.onclick = () => checkAnswer(i, numberCard);
                numbersContainer.appendChild(numberCard);
            }
            
            document.getElementById('feedback').innerHTML = '';
        }

        function checkAnswer(selected, card) {
            attempts++;
            document.getElementById('attempts').textContent = attempts;
            
            const allCards = document.querySelectorAll('.number-card');
            allCards.forEach(c => c.classList.remove('selected'));
            card.classList.add('selected');
            
            const feedback = document.getElementById('feedback');
            
            if (selected === currentAnswer) {
                score++;
                document.getElementById('score').textContent = score;
                
                const config = window.elementSdk?.config || defaultConfig;
                const successMsg = config.success_message || defaultConfig.success_message;
                
                feedback.innerHTML = `
                    <div class="celebrate">
                        <div class="text-green-600 mb-2" style="font-weight: 900; font-size: ${defaultConfig.font_size * 1.5}px;">${successMsg}</div>
                        <div class="text-5xl">ğŸŒŸ â­ ğŸŠ</div>
                    </div>
                `;
                
                card.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
                
                setTimeout(() => {
                    generateQuestion();
                }, 2000);
            } else {
                feedback.innerHTML = `
                    <div class="bounce">
                        <div class="text-red-600 mb-2" style="font-weight: 900; font-size: ${defaultConfig.font_size * 1.5}px;">Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰! ğŸ’ª</div>
                        <div class="text-4xl">ğŸ¤”</div>
                    </div>
                `;
                
                card.style.background = 'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)';
                
                setTimeout(() => {
                    card.style.background = '';
                    card.classList.remove('selected');
                    feedback.innerHTML = '';
                }, 1500);
            }
        }

        document.getElementById('next-btn').onclick = () => {
            generateQuestion();
        };

        async function onConfigChange(config) {
            const baseSize = config.font_size || defaultConfig.font_size;
            const customFont = config.font_family || defaultConfig.font_family;
            const baseFontStack = 'Tajawal, sans-serif';
            
            document.getElementById('lesson-title').textContent = config.lesson_title || defaultConfig.lesson_title;
            document.getElementById('lesson-title').style.fontSize = `${baseSize * 2}px`;
            document.getElementById('lesson-title').style.fontFamily = `${customFont}, ${baseFontStack}`;
            
            document.getElementById('lesson-subtitle').textContent = config.lesson_subtitle || defaultConfig.lesson_subtitle;
            document.getElementById('lesson-subtitle').style.fontSize = `${baseSize * 1.2}px`;
            document.getElementById('lesson-subtitle').style.fontFamily = `${customFont}, ${baseFontStack}`;
            
            document.getElementById('instructions-text').textContent = config.instructions_text || defaultConfig.instructions_text;
            document.getElementById('instructions-text').style.fontSize = `${baseSize}px`;
            document.getElementById('instructions-text').style.fontFamily = `${customFont}, ${baseFontStack}`;
            
            const mainWrapper = document.querySelector('body > div');
            mainWrapper.style.background = `linear-gradient(135deg, ${config.background_color || defaultConfig.background_color} 0%, ${config.primary_color || defaultConfig.primary_color} 100%)`;
            
            const nextBtn = document.getElementById('next-btn');
            nextBtn.style.background = `linear-gradient(to right, ${config.button_color || defaultConfig.button_color}, ${adjustColorBrightness(config.button_color || defaultConfig.button_color, -20)})`;
        }

        function adjustColorBrightness(hex, percent) {
            const num = parseInt(hex.replace('#', ''), 16);
            const r = Math.min(255, Math.max(0, (num >> 16) + percent));
            const g = Math.min(255, Math.max(0, ((num >> 8) & 0x00FF) + percent));
            const b = Math.min(255, Math.max(0, (num & 0x0000FF) + percent));
            return '#' + ((r << 16) | (g << 8) | b).toString(16).padStart(6, '0');
        }

        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig,
                onConfigChange,
                mapToCapabilities: (config) => ({
                    recolorables: [
                        {
                            get: () => config.background_color || defaultConfig.background_color,
                            set: (value) => {
                                config.background_color = value;
                                window.elementSdk.setConfig({ background_color: value });
                            }
                        },
                        {
                            get: () => config.primary_color || defaultConfig.primary_color,
                            set: (value) => {
                                config.primary_color = value;
                                window.elementSdk.setConfig({ primary_color: value });
                            }
                        },
                        {
                            get: () => config.button_color || defaultConfig.button_color,
                            set: (value) => {
                                config.button_color = value;
                                window.elementSdk.setConfig({ button_color: value });
                            }
                        }
                    ],
                    borderables: [],
                    fontEditable: {
                        get: () => config.font_family || defaultConfig.font_family,
                        set: (value) => {
                            config.font_family = value;
                            window.elementSdk.setConfig({ font_family: value });
                        }
                    },
                    fontSizeable: {
                        get: () => config.font_size || defaultConfig.font_size,
                        set: (value) => {
                            config.font_size = value;
                            window.elementSdk.setConfig({ font_size: value });
                        }
                    }
                }),
                mapToEditPanelValues: (config) => new Map([
                    ['lesson_title', config.lesson_title || defaultConfig.lesson_title],
                    ['lesson_subtitle', config.lesson_subtitle || defaultConfig.lesson_subtitle],
                    ['instructions_text', config.instructions_text || defaultConfig.instructions_text],
                    ['success_message', config.success_message || defaultConfig.success_message]
                ])
            });
        }

        generateQuestion();
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9b9bb72c16e19d86',t:'MTc2NzcwNzc1Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
